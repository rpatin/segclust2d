<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Preparing data for Segmentation/Clustering with segclust2d • segclust2d</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Preparing data for Segmentation/Clustering with segclust2d">
<meta property="og:description" content="segclust2d">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">segclust2d</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/explore_outputs.html">Exploring Outputs from segclust2d</a>
    </li>
    <li>
      <a href="../articles/preparing_data.html">Preparing data for Segmentation/Clustering with segclust2d</a>
    </li>
    <li>
      <a href="../articles/run_segclust2d.html">Running Segmentation/Clustering with segclust2d</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rpatin/segclust2d/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="preparing_data_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Preparing data for Segmentation/Clustering with segclust2d</h1>
                        <h4 class="author">R. Patin</h4>
            
            <h4 class="date">2021-09-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rpatin/segclust2d/blob/master/vignettes/preparing_data.Rmd"><code>vignettes/preparing_data.Rmd</code></a></small>
      <div class="hidden name"><code>preparing_data.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rpatin/segclust2d">segclust2d</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">simulshift</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">simulmode</span><span class="op">)</span></code></pre></div>
<div id="type-of-data-accepted-and-content-required-to-run-segmentation-or-segclust" class="section level1">
<h1 class="hasAnchor">
<a href="#type-of-data-accepted-and-content-required-to-run-segmentation-or-segclust" class="anchor"></a>Type of data accepted and content required to run segmentation() or segclust()</h1>
<div id="data-frame" class="section level2">
<h2 class="hasAnchor">
<a href="#data-frame" class="anchor"></a>data.frame</h2>
</div>
<div id="move" class="section level2">
<h2 class="hasAnchor">
<a href="#move" class="anchor"></a>move</h2>
<p>We have shown examples for using data.frames but one can also segment data from <code>ltraj</code> and <code>Move</code> object that contains a single individual.</p>
<div id="concerning-segmentation" class="section level3">
<h3 class="hasAnchor">
<a href="#concerning-segmentation" class="anchor"></a>Concerning segmentation</h3>
<p>For a simple segmentation, the algorithm will assume a home-range segmentation and use coordinates directly.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/segmentation.html">segmentation</a></span><span class="op">(</span><span class="va">ltraj_object</span>, lmin <span class="op">=</span> <span class="fl">5</span>, Kmax <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>
<span class="fu"><a href="../reference/segmentation.html">segmentation</a></span><span class="op">(</span><span class="va">Move_object</span>, lmin <span class="op">=</span> <span class="fl">5</span>, Kmax <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></code></pre></div>
</div>
<div id="concerning-segclust" class="section level3">
<h3 class="hasAnchor">
<a href="#concerning-segclust" class="anchor"></a>Concerning segclust</h3>
<p>For a segmentation/clustering, one has to provide the variables used for segmentation</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/segmentation.html">segmentation</a></span><span class="op">(</span><span class="va">ltraj_object</span>, lmin <span class="op">=</span> <span class="fl">5</span>, Kmax <span class="op">=</span> <span class="fl">25</span>, ncluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, seg.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"speed"</span>,<span class="st">"abs_spatial_angle"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/segmentation.html">segmentation</a></span><span class="op">(</span><span class="va">Move_object</span>, lmin <span class="op">=</span> <span class="fl">5</span>, Kmax <span class="op">=</span> <span class="fl">25</span>, ncluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, seg.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"speed"</span>,<span class="st">"abs_spatial_angle"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Of course the variable names provided must exist as column in <code>Move_object@data</code> and <code><a href="https://rdrr.io/pkg/adehabitatLT/man/burst.html">adehabitatLT::infolocs(ltraj_object[1])</a></code>.</p>
</div>
</div>
<div id="ltraj" class="section level2">
<h2 class="hasAnchor">
<a href="#ltraj" class="anchor"></a>ltraj</h2>
</div>
<div id="sftraj" class="section level2">
<h2 class="hasAnchor">
<a href="#sftraj" class="anchor"></a>sftraj</h2>
</div>
</div>
<div id="limitations-on-data-size-subsampling-smoothing" class="section level1">
<h1 class="hasAnchor">
<a href="#limitations-on-data-size-subsampling-smoothing" class="anchor"></a>Limitations on data size, subsampling &amp; smoothing</h1>
<div id="subsampling" class="section level2">
<h2 class="hasAnchor">
<a href="#subsampling" class="anchor"></a>Subsampling</h2>
<p>Computation cost for the algorithm scales non-linearly and can be both memory and time-consuming. Performance depends on computer, but from what we’ve tested, a segmentation on data of size &gt; 10000 can be quite memory consuming (more than 10Go of RAM) and segmentation-clustering can be quite long for data &gt; 1000 (few minutes to hours). For such dataset we recommend either subsampling if loosing resolution is not a big deal (looking for home-range changes over a year with hourly points might be a lost of time when daily points are sufficient) or if splitting the dataset for very long data. Although for segmentation-clustering, clusters will not be easily comparable between the different part of the dataset, if one provides parts where all cluster are present for sure, there should be no problem.</p>
<p>3 different options are available for subsampling. First one can disable subsampling through argument <code>subsample</code> :</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mode_segclust</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/segclust.html">segclust</a></span><span class="op">(</span><span class="va">simulmode</span>, Kmax <span class="op">=</span> <span class="fl">30</span>, lmin<span class="op">=</span><span class="fl">5</span>, ncluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"behavior"</span>, seg.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"speed"</span>,<span class="st">"abs_spatial_angle"</span><span class="op">)</span>, subsample <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>By default subsampling is allowed (subsample = TRUE) and subsampling will occur if the number of data exceed a threshold (10000 for segmentation, 1000 for segmentation-clustering). The function will subsample by the lower factor (by 2, 3, 4…) for which the dataset will fall below the threshold once subsampled. For instance a 2500 rows dataset for segmentation-clustering would be subsampled by 3 to fall below 1000 rows. The threshold can be changed through argument <code>subsample_over</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mode_segclust</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/segclust.html">segclust</a></span><span class="op">(</span><span class="va">simulmode</span>, Kmax <span class="op">=</span> <span class="fl">30</span>, lmin<span class="op">=</span><span class="fl">5</span>, ncluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"behavior"</span>, seg.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"speed"</span>,<span class="st">"abs_spatial_angle"</span><span class="op">)</span>, subsample_over <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code></pre></div>
<p>One can also override this automatic subsampling by selecting directly the subsampling factor through argument <code>subsample_by</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mode_segclust</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/segclust.html">segclust</a></span><span class="op">(</span><span class="va">simulmode</span>, Kmax <span class="op">=</span> <span class="fl">30</span>, lmin<span class="op">=</span><span class="fl">5</span>, ncluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"behavior"</span>, seg.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"speed"</span>,<span class="st">"abs_spatial_angle"</span><span class="op">)</span>, subsample_by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p>Beware that subsampling will also divide your lmin argument. If subsampling by 2, lmin will be divided by 2. It is important that lmin stays larger than 3 and if possible than 5, for better variance estimations.</p>
<p>Note that subsampling has been implemented in such way that outputs will show all points but segmentation is calculated only on subsampled points. Points used in segmentation can be retrieved through <code>augment</code> in data column <code>subsample_ind</code> (The subsample indices for kept points and NA for ignored points).</p>
</div>
</div>
<div id="covariate-calculations" class="section level1">
<h1 class="hasAnchor">
<a href="#covariate-calculations" class="anchor"></a>Covariate calculations</h1>
<p>The package also includes functions in order to calculate unusual covariates, such as the turning angle at constant step length (here called <code>spatial_angle</code>). For the latter, a radius have to be chosen and can be specified through argument <code>radius</code>. If no radius is specified, the default one will be the median of the step length distribution. Other covariates calculated are : persistence and turning speed (v_p and v_r) from Gurarie et al (2009), distance travelled between points, speed and smoothed version of the latter. Covariates dependent on time interval (like speed) are by default calculated with hours, but you can change this with argument <code>units</code> as in the example below.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simple_data</span> <span class="op">&lt;-</span> <span class="va">simulmode</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dateTime"</span>,<span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span>
<span class="va">full_data</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_covariates.html">add_covariates</a></span><span class="op">(</span><span class="va">simple_data</span>, coord.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span>, timecol <span class="op">=</span> <span class="st">"dateTime"</span>,smoothed <span class="op">=</span> <span class="cn">TRUE</span>, units <span class="op">=</span><span class="st">"min"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">full_data</span><span class="op">)</span></code></pre></div>
</div>
<div id="advise-on-data-pre-processing" class="section level1">
<h1 class="hasAnchor">
<a href="#advise-on-data-pre-processing" class="anchor"></a>Advise on data pre-processing</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Remi Patin, Marie-Pierre Etienne, Emilie Lebarbier, Simon Benhamou.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
